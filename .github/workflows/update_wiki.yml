# This file is part of the DiscoPoP software (http://www.discopop.tu-darmstadt.de)
#
# Copyright (c) 2020, Technische Universitaet Darmstadt, Germany
#
# This software may be modified and distributed under the terms of
# the 3-Clause BSD License.  See the LICENSE file in the package base
# directory for details.

name: "Update Wiki"

on:
  push:
    branches:
      - 133-create-documentation-website-in-addition-to-wiki-tab
jobs:
  update-wiki:
    runs-on: ubuntu-latest
    name: "Update Wiki"
    steps:
      - name: "Checkout Repository"
        uses: actions/checkout@v2

      - name: "Check out wiki"
        uses: actions/checkout@v2
        with:
            repository: 'discopop-project/discopop.wiki'
            ref: 'master'
            path: 'discopop.wiki'
      - name: "overwrite wiki contents"
        run: |
          cp -r docs/* discopop.wiki
      -name: "rename index.md to Home.md"
        run: |
          mv discopop.wiki/index.md discopop.wiki/Home.md
      - name: "Commit to wiki"
        run: |
          cd discopop.wiki
          git config --global user.email "discopop[at]lists.parallel.informatik.tu-darmstadt.de"
          git config --global user.name "DiscoPoP CI"
          git add *
          git diff-index --quiet HEAD || git commit -m 'Automatic update of wiki'
      - name: "Push to wiki"
        run: |
          cd discopop.wiki
          git push